<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CAP_FIT.TicketManagement.Repository.TicketRepository">

  <select id="userList" resultType="CAP_FIT.TicketManagement.Data.User">
    SELECT * FROM gym_user
  </select>

  <select id="ticketsList" resultType="CAP_FIT.TicketManagement.Data.Tickets">
    SELECT * FROM tickets
  </select>

  <select id="selectUserList" resultType="CAP_FIT.TicketManagement.Data.User">
    SELECT * FROM gym_user WHERE name = #{name}
  </select>

  <insert id="insertUser" parameterType="CAP_FIT.TicketManagement.Data.User">
   INSERT INTO gym_user (id, name, email_address, membership_fee, admission_day)
   VALUES (#{id}, #{name}, #{emailAddress}, #{membershipFee}, #{admissionDay});
  </insert>

  <insert id="insertTickets" parameterType="CAP_FIT.TicketManagement.Data.Tickets" useGeneratedKeys="true" keyProperty="ticketNumber">
    INSERT INTO tickets (user_id, remaining, buy_day, user_name, ticket_name)
    VALUES (#{userId}, #{remaining}, #{buyDay}, #{userName}, #{ticketName});
  </insert>

  <update id="updateUser" parameterType="CAP_FIT.TicketManagement.Data.User">
    UPDATE gym_user
    SET name = #{name}, email_address = #{emailAddress}, membership_fee = #{membershipFee}, admission_day = #{admissionDay}
    WHERE id = #{id}
  </update>

  <update id="updateTickets" parameterType="CAP_FIT.TicketManagement.Data.Tickets">
    UPDATE  tickets
    SET remaining = #{remaining}, buy_day = #{buyDay}, user_name = #{userName},  ticket_name = #{ticketName}
    WHERE ticket_number = #{ticketNumber} AND user_id = #{userId}
  </update>
  
  <delete id="deleteUser" parameterType="CAP_FIT.TicketManagement.Data.User">
    DELETE FROM gym_user WHERE id = #{id} AND name = #{name}
  </delete>

  <delete id="deleteTickets" parameterType="CAP_FIT.TicketManagement.Data.Tickets">
    DELETE FROM tickets WHERE user_id = #{userId}
  </delete>

</mapper>